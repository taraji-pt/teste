<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>EV‑Based Bet Sizing Calc</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #f3f4f6;
        margin: 0;
        padding: 40px;
        display: flex;
        justify-content: center;
    }
    .card {
        background: #ffffff;
        padding: 30px;
        border-radius: 16px;
        box-shadow: 0 8px 24px rgba(0,0,0,0.12);
        width: 100%;
        max-width: 480px;
    }
    h2 {
        text-align: center;
        margin-top: 0;
        color: #111827;
    }
    label {
        font-weight: 600;
        display: block;
        margin-top: 18px;
        color: #374151;
    }
    input {
        width: 100%;
        padding: 12px;
        margin-top: 6px;
        border: 1px solid #d1d5db;
        border-radius: 10px;
        font-size: 16px;
    }
    button {
        width: 100%;
        margin-top: 26px;
        padding: 14px;
        border: none;
        border-radius: 12px;
        background: #2563eb;
        color: white;
        font-size: 17px;
        font-weight: 600;
        cursor: pointer;
        transition: 0.2s;
    }
    button:hover { background: #1e4fcc; }

    .result {
        margin-top: 28px;
        background: #f9fafb;
        padding: 18px;
        border-radius: 12px;
        border: 1px solid #e5e7eb;
        font-size: 17px;
        color: #111827;
    }
</style>
</head>
<body>
<div class="card">
    <h2>EV‑Based Bet Sizing</h2>

    <label>Vote %</label>
    <input id="vote" type="number" placeholder="e.g. 63" />

    <label>Odds</label>
    <input id="odds" type="number" step="0.01" placeholder="e.g. 1.85" />

    <button onclick="calc()">Calculate</button>

    <div id="output" class="result" style="display:none"></div>
</div>

<script>
function calc() {
    const v = parseFloat(document.getElementById('vote').value);
    const o = parseFloat(document.getElementById('odds').value);

    if (isNaN(v) || isNaN(o)) return;

    // --- Probability calibration model (your formula) ---
    const p = 0.209 + 0.00542 * v;

    // --- EV calculation ---
    const EV = p * (o - 1) - (1 - p);

    // --- Full Kelly ---
    const k = (p * (o - 1) - (1 - p)) / (o - 1);

    // --- Gate rule (your new logic) ---
    const pass = EV >= 0.10;

    // --- Stake suggestion ---
    let stake = pass ? Math.max(0.25, Math.min(k, 1)) : 0;;
    stake = Math.round(stake * 100) / 100;

    document.getElementById('output').style.display = 'block';
    document.getElementById('output').innerHTML = `
        <strong>Calibrated p:</strong> ${(p*100).toFixed(1)}%<br>
        <strong>EV:</strong> ${EV.toFixed(3)}<br>
        <strong>Full Kelly:</strong> ${k.toFixed(3)}<br><br>
        <strong>Gate (EV ≥ 0.10):</strong> ${pass ? '✔ Pass' : '✖ Block'}<br><br>
        <strong>Suggested Stake (updated range):</strong> ${stake} units
    `;
}
</script>

</body>
</html>
